var _=Object.create;var q=Object.defineProperty;var B=Object.getOwnPropertyDescriptor;var G=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,Q=Object.prototype.hasOwnProperty;var X=(l,c)=>()=>(c||l((c={exports:{}}).exports,c),c.exports);var Y=(l,c,b,m)=>{if(c&&typeof c=="object"||typeof c=="function")for(let u of G(c))!Q.call(l,u)&&u!==b&&q(l,u,{get:()=>c[u],enumerable:!(m=B(c,u))||m.enumerable});return l};var Z=(l,c,b)=>(b=l!=null?_(J(l)):{},Y(c||!l||!l.__esModule?q(b,"default",{value:l,enumerable:!0}):b,l));var V=X((N,k)=>{(function(l){"use strict";function c(e,i){var t=(e&65535)+(i&65535),d=(e>>16)+(i>>16)+(t>>16);return d<<16|t&65535}function b(e,i){return e<<i|e>>>32-i}function m(e,i,t,d,h,w){return c(b(c(c(i,e),c(d,w)),h),t)}function u(e,i,t,d,h,w,v){return m(i&t|~i&d,e,i,h,w,v)}function f(e,i,t,d,h,w,v){return m(i&d|t&~d,e,i,h,w,v)}function g(e,i,t,d,h,w,v){return m(i^t^d,e,i,h,w,v)}function a(e,i,t,d,h,w,v){return m(t^(i|~d),e,i,h,w,v)}function y(e,i){e[i>>5]|=128<<i%32,e[(i+64>>>9<<4)+14]=i;var t,d,h,w,v,o=1732584193,n=-271733879,s=-1732584194,r=271733878;for(t=0;t<e.length;t+=16)d=o,h=n,w=s,v=r,o=u(o,n,s,r,e[t],7,-680876936),r=u(r,o,n,s,e[t+1],12,-389564586),s=u(s,r,o,n,e[t+2],17,606105819),n=u(n,s,r,o,e[t+3],22,-1044525330),o=u(o,n,s,r,e[t+4],7,-176418897),r=u(r,o,n,s,e[t+5],12,1200080426),s=u(s,r,o,n,e[t+6],17,-1473231341),n=u(n,s,r,o,e[t+7],22,-45705983),o=u(o,n,s,r,e[t+8],7,1770035416),r=u(r,o,n,s,e[t+9],12,-1958414417),s=u(s,r,o,n,e[t+10],17,-42063),n=u(n,s,r,o,e[t+11],22,-1990404162),o=u(o,n,s,r,e[t+12],7,1804603682),r=u(r,o,n,s,e[t+13],12,-40341101),s=u(s,r,o,n,e[t+14],17,-1502002290),n=u(n,s,r,o,e[t+15],22,1236535329),o=f(o,n,s,r,e[t+1],5,-165796510),r=f(r,o,n,s,e[t+6],9,-1069501632),s=f(s,r,o,n,e[t+11],14,643717713),n=f(n,s,r,o,e[t],20,-373897302),o=f(o,n,s,r,e[t+5],5,-701558691),r=f(r,o,n,s,e[t+10],9,38016083),s=f(s,r,o,n,e[t+15],14,-660478335),n=f(n,s,r,o,e[t+4],20,-405537848),o=f(o,n,s,r,e[t+9],5,568446438),r=f(r,o,n,s,e[t+14],9,-1019803690),s=f(s,r,o,n,e[t+3],14,-187363961),n=f(n,s,r,o,e[t+8],20,1163531501),o=f(o,n,s,r,e[t+13],5,-1444681467),r=f(r,o,n,s,e[t+2],9,-51403784),s=f(s,r,o,n,e[t+7],14,1735328473),n=f(n,s,r,o,e[t+12],20,-1926607734),o=g(o,n,s,r,e[t+5],4,-378558),r=g(r,o,n,s,e[t+8],11,-2022574463),s=g(s,r,o,n,e[t+11],16,1839030562),n=g(n,s,r,o,e[t+14],23,-35309556),o=g(o,n,s,r,e[t+1],4,-1530992060),r=g(r,o,n,s,e[t+4],11,1272893353),s=g(s,r,o,n,e[t+7],16,-155497632),n=g(n,s,r,o,e[t+10],23,-1094730640),o=g(o,n,s,r,e[t+13],4,681279174),r=g(r,o,n,s,e[t],11,-358537222),s=g(s,r,o,n,e[t+3],16,-722521979),n=g(n,s,r,o,e[t+6],23,76029189),o=g(o,n,s,r,e[t+9],4,-640364487),r=g(r,o,n,s,e[t+12],11,-421815835),s=g(s,r,o,n,e[t+15],16,530742520),n=g(n,s,r,o,e[t+2],23,-995338651),o=a(o,n,s,r,e[t],6,-198630844),r=a(r,o,n,s,e[t+7],10,1126891415),s=a(s,r,o,n,e[t+14],15,-1416354905),n=a(n,s,r,o,e[t+5],21,-57434055),o=a(o,n,s,r,e[t+12],6,1700485571),r=a(r,o,n,s,e[t+3],10,-1894986606),s=a(s,r,o,n,e[t+10],15,-1051523),n=a(n,s,r,o,e[t+1],21,-2054922799),o=a(o,n,s,r,e[t+8],6,1873313359),r=a(r,o,n,s,e[t+15],10,-30611744),s=a(s,r,o,n,e[t+6],15,-1560198380),n=a(n,s,r,o,e[t+13],21,1309151649),o=a(o,n,s,r,e[t+4],6,-145523070),r=a(r,o,n,s,e[t+11],10,-1120210379),s=a(s,r,o,n,e[t+2],15,718787259),n=a(n,s,r,o,e[t+9],21,-343485551),o=c(o,d),n=c(n,h),s=c(s,w),r=c(r,v);return[o,n,s,r]}function C(e){var i,t="",d=e.length*32;for(i=0;i<d;i+=8)t+=String.fromCharCode(e[i>>5]>>>i%32&255);return t}function E(e){var i,t=[];for(t[(e.length>>2)-1]=void 0,i=0;i<t.length;i+=1)t[i]=0;var d=e.length*8;for(i=0;i<d;i+=8)t[i>>5]|=(e.charCodeAt(i/8)&255)<<i%32;return t}function R(e){return C(y(E(e),e.length*8))}function T(e,i){var t,d=E(e),h=[],w=[],v;for(h[15]=w[15]=void 0,d.length>16&&(d=y(d,e.length*8)),t=0;t<16;t+=1)h[t]=d[t]^909522486,w[t]=d[t]^1549556828;return v=y(h.concat(E(i)),512+i.length*8),C(y(w.concat(v),640))}function D(e){var i="0123456789abcdef",t="",d,h;for(h=0;h<e.length;h+=1)d=e.charCodeAt(h),t+=i.charAt(d>>>4&15)+i.charAt(d&15);return t}function I(e){return unescape(encodeURIComponent(e))}function A(e){return R(I(e))}function O(e){return D(A(e))}function $(e,i){return T(I(e),I(i))}function L(e,i){return D($(e,i))}function M(e,i,t){return i?t?$(i,e):L(i,e):t?A(e):O(e)}typeof define=="function"&&define.amd?define(function(){return M}):typeof k=="object"&&k.exports?k.exports=M:l.md5=M})(N)});var W=Z(V(),1),j={},F={};function x(l){return[216e5,864e5,1728e5,6048e5,12096e5,null][l]??null}var P=2*24*60*60*1e3,U=!1,p=!1,H=!1,K=!1;function S(l){return(0,W.default)(l)}async function ee(){let l=await new Promise(b=>chrome.storage.local.get(["deleteThreshold","hideCrossposts","debugMode","lessAggressivePruning","incognito"],b));P=l.deleteThreshold??P,U=l.hideCrossposts??U,p=l.debugMode??p,H=l.lessAggressivePruning??H,K=l.incognito??K;let c=null;if(P!==null&&(c=x(P)),c!==null){let b=Date.now()-c;P=b,p&&console.log(`Cutoff time is ${new Date(b).toISOString()}`)}else P=null,p&&console.log("Delete threshold is set to 'Never'; no deletions will occur.");p&&console.log("Settings loaded: ",l)}async function te(){let l=Date.now();if(P===null)return;let{seenPostsSubreddit:c={},seenPostsID:b={}}=await new Promise(a=>chrome.storage.local.get(["seenPostsSubreddit","seenPostsID"],a)),m={},u={};for(let[a,y]of Object.entries(c))l-y.timestamp<P?m[a]=y:p&&console.log(`Removing expired subreddit entry: ${a}`);for(let[a,y]of Object.entries(b))l-y.timestamp<P?u[a]=y:p&&console.log(`Removing expired postID entry: ${a}`);let f=Object.keys(m).length!==Object.keys(c).length,g=Object.keys(u).length!==Object.keys(b).length;f&&await new Promise(a=>chrome.storage.local.set({seenPostsSubreddit:m},a)),g&&await new Promise(a=>chrome.storage.local.set({seenPostsID:u},a))}function z(){let l=Date.now(),c=document.querySelectorAll("article"),b=!1,m=!1;c.forEach(u=>{let f=u.querySelector("shreddit-post");if(!f)return;let g=!1;U&&(g=oe(f),p&&g&&console.log("Filtered post based on crosspost"));let a=f.getAttribute("content-href")?.toLowerCase()||"",y=f.getAttribute("author")?.toLowerCase()||"",C=f.getAttribute("subreddit-name")?.toLowerCase()||"",E=S(a),R=S(y),T=S(C),D=S(`${E}|${R}`);p&&console.log(`Key (content|author): ${D}, Subreddit: ${C}`);let I=j[D];I?I.subreddit!==T&&(g=!0,p&&console.log(`Filtered duplicate from another subreddit: ${T}`)):(j[D]={subreddit:T,timestamp:l},b=!0);let A=f.getAttribute("post-title")||"",O=f.getAttribute("id")||"",$=S(A),L=S(O),M=S(`${$}|${R}`);if(p&&console.log(`Post Key (title|author): ${A}|${R}`),!g&&!H){let e=F[M];e?e.postID!==L&&(g=!0,p&&console.log(`Filtered duplicate with similar title: ${A}`)):(F[M]={postID:L,timestamp:l},m=!0)}g&&(u.style.display="none")}),b&&chrome.storage.local.set({seenPostsSubreddit:j}),m&&chrome.storage.local.set({seenPostsID:F})}function oe(l){return l?.hasAttribute("post-type")&&l.getAttribute("post-type")?.toLowerCase()==="crosspost"}async function ne(){await ee();let l;if(chrome.windows&&await chrome.windows.getCurrent()&&(l=await new Promise(m=>{chrome.runtime.sendMessage({type:"getIncognitoStatus"},u=>{m(u?.isIncognito??!1)})})),K&&!l){p&&console.log("Incognito Exclusive Mode is enabled, but this window is not incognito. Exiting...");return}await te(),z();let c;new MutationObserver(()=>{clearTimeout(c),c=window.setTimeout(()=>{z()},50)}).observe(document.body,{childList:!0,subtree:!0})}ne();
