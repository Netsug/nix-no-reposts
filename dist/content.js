var J=Object.create;var U=Object.defineProperty;var K=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var Q=Object.getPrototypeOf,V=Object.prototype.hasOwnProperty;var X=(a,u)=>()=>(u||a((u={exports:{}}).exports,u),u.exports);var Y=(a,u,v,m)=>{if(u&&typeof u=="object"||typeof u=="function")for(let c of N(u))!V.call(a,c)&&c!==v&&U(a,c,{get:()=>u[c],enumerable:!(m=K(u,c))||m.enumerable});return a};var Z=(a,u,v)=>(v=a!=null?J(Q(a)):{},Y(u||!a||!a.__esModule?U(v,"default",{value:a,enumerable:!0}):v,a));var z=X((q,M)=>{(function(a){"use strict";function u(e,i){var t=(e&65535)+(i&65535),f=(e>>16)+(i>>16)+(t>>16);return f<<16|t&65535}function v(e,i){return e<<i|e>>>32-i}function m(e,i,t,f,b,p){return u(v(u(u(i,e),u(f,p)),b),t)}function c(e,i,t,f,b,p,w){return m(i&t|~i&f,e,i,b,p,w)}function d(e,i,t,f,b,p,w){return m(i&f|t&~f,e,i,b,p,w)}function g(e,i,t,f,b,p,w){return m(i^t^f,e,i,b,p,w)}function l(e,i,t,f,b,p,w){return m(t^(i|~f),e,i,b,p,w)}function h(e,i){e[i>>5]|=128<<i%32,e[(i+64>>>9<<4)+14]=i;var t,f,b,p,w,o=1732584193,r=-271733879,n=-1732584194,s=271733878;for(t=0;t<e.length;t+=16)f=o,b=r,p=n,w=s,o=c(o,r,n,s,e[t],7,-680876936),s=c(s,o,r,n,e[t+1],12,-389564586),n=c(n,s,o,r,e[t+2],17,606105819),r=c(r,n,s,o,e[t+3],22,-1044525330),o=c(o,r,n,s,e[t+4],7,-176418897),s=c(s,o,r,n,e[t+5],12,1200080426),n=c(n,s,o,r,e[t+6],17,-1473231341),r=c(r,n,s,o,e[t+7],22,-45705983),o=c(o,r,n,s,e[t+8],7,1770035416),s=c(s,o,r,n,e[t+9],12,-1958414417),n=c(n,s,o,r,e[t+10],17,-42063),r=c(r,n,s,o,e[t+11],22,-1990404162),o=c(o,r,n,s,e[t+12],7,1804603682),s=c(s,o,r,n,e[t+13],12,-40341101),n=c(n,s,o,r,e[t+14],17,-1502002290),r=c(r,n,s,o,e[t+15],22,1236535329),o=d(o,r,n,s,e[t+1],5,-165796510),s=d(s,o,r,n,e[t+6],9,-1069501632),n=d(n,s,o,r,e[t+11],14,643717713),r=d(r,n,s,o,e[t],20,-373897302),o=d(o,r,n,s,e[t+5],5,-701558691),s=d(s,o,r,n,e[t+10],9,38016083),n=d(n,s,o,r,e[t+15],14,-660478335),r=d(r,n,s,o,e[t+4],20,-405537848),o=d(o,r,n,s,e[t+9],5,568446438),s=d(s,o,r,n,e[t+14],9,-1019803690),n=d(n,s,o,r,e[t+3],14,-187363961),r=d(r,n,s,o,e[t+8],20,1163531501),o=d(o,r,n,s,e[t+13],5,-1444681467),s=d(s,o,r,n,e[t+2],9,-51403784),n=d(n,s,o,r,e[t+7],14,1735328473),r=d(r,n,s,o,e[t+12],20,-1926607734),o=g(o,r,n,s,e[t+5],4,-378558),s=g(s,o,r,n,e[t+8],11,-2022574463),n=g(n,s,o,r,e[t+11],16,1839030562),r=g(r,n,s,o,e[t+14],23,-35309556),o=g(o,r,n,s,e[t+1],4,-1530992060),s=g(s,o,r,n,e[t+4],11,1272893353),n=g(n,s,o,r,e[t+7],16,-155497632),r=g(r,n,s,o,e[t+10],23,-1094730640),o=g(o,r,n,s,e[t+13],4,681279174),s=g(s,o,r,n,e[t],11,-358537222),n=g(n,s,o,r,e[t+3],16,-722521979),r=g(r,n,s,o,e[t+6],23,76029189),o=g(o,r,n,s,e[t+9],4,-640364487),s=g(s,o,r,n,e[t+12],11,-421815835),n=g(n,s,o,r,e[t+15],16,530742520),r=g(r,n,s,o,e[t+2],23,-995338651),o=l(o,r,n,s,e[t],6,-198630844),s=l(s,o,r,n,e[t+7],10,1126891415),n=l(n,s,o,r,e[t+14],15,-1416354905),r=l(r,n,s,o,e[t+5],21,-57434055),o=l(o,r,n,s,e[t+12],6,1700485571),s=l(s,o,r,n,e[t+3],10,-1894986606),n=l(n,s,o,r,e[t+10],15,-1051523),r=l(r,n,s,o,e[t+1],21,-2054922799),o=l(o,r,n,s,e[t+8],6,1873313359),s=l(s,o,r,n,e[t+15],10,-30611744),n=l(n,s,o,r,e[t+6],15,-1560198380),r=l(r,n,s,o,e[t+13],21,1309151649),o=l(o,r,n,s,e[t+4],6,-145523070),s=l(s,o,r,n,e[t+11],10,-1120210379),n=l(n,s,o,r,e[t+2],15,718787259),r=l(r,n,s,o,e[t+9],21,-343485551),o=u(o,f),r=u(r,b),n=u(n,p),s=u(s,w);return[o,r,n,s]}function D(e){var i,t="",f=e.length*32;for(i=0;i<f;i+=8)t+=String.fromCharCode(e[i>>5]>>>i%32&255);return t}function y(e){var i,t=[];for(t[(e.length>>2)-1]=void 0,i=0;i<t.length;i+=1)t[i]=0;var f=e.length*8;for(i=0;i<f;i+=8)t[i>>5]|=(e.charCodeAt(i/8)&255)<<i%32;return t}function E(e){return D(h(y(e),e.length*8))}function S(e,i){var t,f=y(e),b=[],p=[],w;for(b[15]=p[15]=void 0,f.length>16&&(f=h(f,e.length*8)),t=0;t<16;t+=1)b[t]=f[t]^909522486,p[t]=f[t]^1549556828;return w=h(b.concat(y(i)),512+i.length*8),D(h(p.concat(w),640))}function A(e){var i="0123456789abcdef",t="",f,b;for(b=0;b<e.length;b+=1)f=e.charCodeAt(b),t+=i.charAt(f>>>4&15)+i.charAt(f&15);return t}function C(e){return unescape(encodeURIComponent(e))}function k(e){return E(C(e))}function B(e){return A(k(e))}function H(e,i){return S(C(e),C(i))}function G(e,i){return A(H(e,i))}function $(e,i,t){return i?t?H(i,e):G(i,e):t?k(e):B(e)}typeof define=="function"&&define.amd?define(function(){return $}):typeof M=="object"&&M.exports?M.exports=$:a.md5=$})(q)});var _=Z(z(),1),L={},R={},T=2*24*60*60*1e3,O=!0,P=!0,j=!1,F=!1;function I(a){return(0,_.default)(a)}async function x(){let a=await new Promise(u=>chrome.storage.local.get(["deleteThreshold","isFilteringCrossposts","isDebugging","lessAggressivePruning","incognito"],u));T=a.deleteThreshold??T,O=a.isFilteringCrossposts??O,P=a.isDebugging??P,j=a.lessAggressivePruning??j,F=a.incognito??F,P&&console.log("Settings loaded: ",a)}async function ee(){let a=Date.now(),{seenPostsSubreddit:u={},seenPostsID:v={}}=await new Promise(l=>chrome.storage.local.get(["seenPostsSubreddit","seenPostsID"],l)),m={},c={};for(let[l,h]of Object.entries(u))a-h.timestamp<T?m[l]=h:P&&console.log(`Removing expired subreddit entry: ${l}`);for(let[l,h]of Object.entries(v))a-h.timestamp<T?c[l]=h:P&&console.log(`Removing expired postID entry: ${l}`);let d=Object.keys(m).length!==Object.keys(u).length,g=Object.keys(c).length!==Object.keys(v).length;d&&await new Promise(l=>chrome.storage.local.set({seenPostsSubreddit:m},l)),g&&await new Promise(l=>chrome.storage.local.set({seenPostsID:c},l))}function W(){let a=Date.now(),u=document.querySelectorAll("article"),v=!1,m=!1;u.forEach(c=>{let d=c.querySelector("shreddit-post");if(!d)return;let g=!1;O&&(g=te(d),P&&g&&console.log("Filtered post based on crosspost"));let l,h,D;P?(l=d.getAttribute("content-href")?.toLowerCase()||"",h=d.getAttribute("author")?.toLowerCase()||"",D=d.getAttribute("subreddit-name")?.toLowerCase()||""):(l=I(d.getAttribute("content-href")?.toLowerCase()||""),h=I(d.getAttribute("author")?.toLowerCase()||""),D=I(d.getAttribute("subreddit-name")?.toLowerCase()||""));let y;P?y=`${l}|${h}`:y=I(`${l}|${h}`);let E=L[y];E?E.subreddit!==D&&(g=!0,P&&console.log(`Filtered duplicate from another subreddit: ${D}`)):(L[y]={subreddit:D,timestamp:a},v=!0);let S,A;if(P?(S=d.getAttribute("post-title")||"",A=d.getAttribute("id")||"",y=`${S}|${h}`):(S=I(d.getAttribute("post-title")||""),A=I(d.getAttribute("id")||""),y=I(`${S}|${h}`)),!g&&!j){let C=R[y];C?C.postID!=A&&(g=!0,P&&console.log(`Filtered duplicate with similar title: ${S}`)):(R[y]={postID:A,timestamp:a},m=!0)}g&&(c.style.display="none")}),v&&chrome.storage.local.set({seenPostsSubreddit:L}),m&&chrome.storage.local.set({seenPostsID:R})}function te(a){return a?.hasAttribute("post-type")&&a.getAttribute("post-type")?.toLowerCase()==="crosspost"}async function oe(){await x();let a;if(chrome.windows&&await chrome.windows.getCurrent()&&(a=await new Promise(m=>{chrome.runtime.sendMessage({type:"getIncognitoStatus"},c=>{m(c?.isIncognito??!1)})})),F&&!a){P&&console.log("Incognito Exclusive Mode is enabled, but this window is not incognito. Exiting...");return}await ee(),W();let u;new MutationObserver(()=>{clearTimeout(u),u=window.setTimeout(()=>{W()},50)}).observe(document.body,{childList:!0,subtree:!0})}oe();
